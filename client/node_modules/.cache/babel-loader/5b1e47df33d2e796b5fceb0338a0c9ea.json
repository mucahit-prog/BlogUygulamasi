{"ast":null,"code":"/**\n * @license Copyright (c) 2003-2019, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module block-quote/blockquoteediting\n */\nimport Plugin from '@ckeditor/ckeditor5-core/src/plugin';\nimport BlockQuoteCommand from './blockquotecommand';\n/**\n * The block quote editing.\n *\n * Introduces the `'blockQuote'` command and the `'blockQuote'` model element.\n *\n * @extends module:core/plugin~Plugin\n */\n\nexport default class BlockQuoteEditing extends Plugin {\n  /**\n   * @inheritDoc\n   */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    editor.commands.add('blockQuote', new BlockQuoteCommand(editor));\n    schema.register('blockQuote', {\n      allowWhere: '$block',\n      allowContentOf: '$root'\n    }); // Disallow blockQuote in blockQuote.\n\n    schema.addChildCheck((ctx, childDef) => {\n      if (ctx.endsWith('blockQuote') && childDef.name == 'blockQuote') {\n        return false;\n      }\n    });\n    editor.conversion.elementToElement({\n      model: 'blockQuote',\n      view: 'blockquote'\n    }); // Postfixer which cleans incorrect model states connected with block quotes.\n\n    editor.model.document.registerPostFixer(writer => {\n      const changes = editor.model.document.differ.getChanges();\n\n      for (const entry of changes) {\n        if (entry.type == 'insert') {\n          const element = entry.position.nodeAfter;\n\n          if (!element) {\n            // We are inside a text node.\n            continue;\n          }\n\n          if (element.is('blockQuote') && element.isEmpty) {\n            // Added an empty blockQuote - remove it.\n            writer.remove(element);\n            return true;\n          } else if (element.is('blockQuote') && !schema.checkChild(entry.position, element)) {\n            // Added a blockQuote in incorrect place - most likely inside another blockQuote. Unwrap it\n            // so the content inside is not lost.\n            writer.unwrap(element);\n            return true;\n          } else if (element.is('element')) {\n            // Just added an element. Check its children to see if there are no nested blockQuotes somewhere inside.\n            const range = writer.createRangeIn(element);\n\n            for (const child of range.getItems()) {\n              if (child.is('blockQuote') && !schema.checkChild(writer.createPositionBefore(child), child)) {\n                writer.unwrap(child);\n                return true;\n              }\n            }\n          }\n        } else if (entry.type == 'remove') {\n          const parent = entry.position.parent;\n\n          if (parent.is('blockQuote') && parent.isEmpty) {\n            // Something got removed and now blockQuote is empty. Remove the blockQuote as well.\n            writer.remove(parent);\n            return true;\n          }\n        }\n      }\n\n      return false;\n    });\n  }\n  /**\n   * @inheritDoc\n   */\n\n\n  afterInit() {\n    const editor = this.editor;\n    const command = editor.commands.get('blockQuote'); // Overwrite default Enter key behavior.\n    // If Enter key is pressed with selection collapsed in empty block inside a quote, break the quote.\n    // This listener is added in afterInit in order to register it after list's feature listener.\n    // We can't use a priority for this, because 'low' is already used by the enter feature, unless\n    // we'd use numeric priority in this case.\n\n    this.listenTo(this.editor.editing.view.document, 'enter', (evt, data) => {\n      const doc = this.editor.model.document;\n      const positionParent = doc.selection.getLastPosition().parent;\n\n      if (doc.selection.isCollapsed && positionParent.isEmpty && command.value) {\n        this.editor.execute('blockQuote');\n        this.editor.editing.view.scrollToTheSelection();\n        data.preventDefault();\n        evt.stop();\n      }\n    });\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Valanis/Desktop/React-Docs-Practice/BlogUygulamasÄ±/client/node_modules/@ckeditor/ckeditor5-block-quote/src/blockquoteediting.js"],"names":["Plugin","BlockQuoteCommand","BlockQuoteEditing","init","editor","schema","model","commands","add","register","allowWhere","allowContentOf","addChildCheck","ctx","childDef","endsWith","name","conversion","elementToElement","view","document","registerPostFixer","writer","changes","differ","getChanges","entry","type","element","position","nodeAfter","is","isEmpty","remove","checkChild","unwrap","range","createRangeIn","child","getItems","createPositionBefore","parent","afterInit","command","get","listenTo","editing","evt","data","doc","positionParent","selection","getLastPosition","isCollapsed","value","execute","scrollToTheSelection","preventDefault","stop"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2019, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module block-quote/blockquoteediting\n */\n\nimport Plugin from '@ckeditor/ckeditor5-core/src/plugin';\n\nimport BlockQuoteCommand from './blockquotecommand';\n\n/**\n * The block quote editing.\n *\n * Introduces the `'blockQuote'` command and the `'blockQuote'` model element.\n *\n * @extends module:core/plugin~Plugin\n */\nexport default class BlockQuoteEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tinit() {\n\t\tconst editor = this.editor;\n\t\tconst schema = editor.model.schema;\n\n\t\teditor.commands.add( 'blockQuote', new BlockQuoteCommand( editor ) );\n\n\t\tschema.register( 'blockQuote', {\n\t\t\tallowWhere: '$block',\n\t\t\tallowContentOf: '$root'\n\t\t} );\n\n\t\t// Disallow blockQuote in blockQuote.\n\t\tschema.addChildCheck( ( ctx, childDef ) => {\n\t\t\tif ( ctx.endsWith( 'blockQuote' ) && childDef.name == 'blockQuote' ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} );\n\n\t\teditor.conversion.elementToElement( { model: 'blockQuote', view: 'blockquote' } );\n\n\t\t// Postfixer which cleans incorrect model states connected with block quotes.\n\t\teditor.model.document.registerPostFixer( writer => {\n\t\t\tconst changes = editor.model.document.differ.getChanges();\n\n\t\t\tfor ( const entry of changes ) {\n\t\t\t\tif ( entry.type == 'insert' ) {\n\t\t\t\t\tconst element = entry.position.nodeAfter;\n\n\t\t\t\t\tif ( !element ) {\n\t\t\t\t\t\t// We are inside a text node.\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( element.is( 'blockQuote' ) && element.isEmpty ) {\n\t\t\t\t\t\t// Added an empty blockQuote - remove it.\n\t\t\t\t\t\twriter.remove( element );\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if ( element.is( 'blockQuote' ) && !schema.checkChild( entry.position, element ) ) {\n\t\t\t\t\t\t// Added a blockQuote in incorrect place - most likely inside another blockQuote. Unwrap it\n\t\t\t\t\t\t// so the content inside is not lost.\n\t\t\t\t\t\twriter.unwrap( element );\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if ( element.is( 'element' ) ) {\n\t\t\t\t\t\t// Just added an element. Check its children to see if there are no nested blockQuotes somewhere inside.\n\t\t\t\t\t\tconst range = writer.createRangeIn( element );\n\n\t\t\t\t\t\tfor ( const child of range.getItems() ) {\n\t\t\t\t\t\t\tif ( child.is( 'blockQuote' ) && !schema.checkChild( writer.createPositionBefore( child ), child ) ) {\n\t\t\t\t\t\t\t\twriter.unwrap( child );\n\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if ( entry.type == 'remove' ) {\n\t\t\t\t\tconst parent = entry.position.parent;\n\n\t\t\t\t\tif ( parent.is( 'blockQuote' ) && parent.isEmpty ) {\n\t\t\t\t\t\t// Something got removed and now blockQuote is empty. Remove the blockQuote as well.\n\t\t\t\t\t\twriter.remove( parent );\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t} );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tafterInit() {\n\t\tconst editor = this.editor;\n\t\tconst command = editor.commands.get( 'blockQuote' );\n\n\t\t// Overwrite default Enter key behavior.\n\t\t// If Enter key is pressed with selection collapsed in empty block inside a quote, break the quote.\n\t\t// This listener is added in afterInit in order to register it after list's feature listener.\n\t\t// We can't use a priority for this, because 'low' is already used by the enter feature, unless\n\t\t// we'd use numeric priority in this case.\n\t\tthis.listenTo( this.editor.editing.view.document, 'enter', ( evt, data ) => {\n\t\t\tconst doc = this.editor.model.document;\n\t\t\tconst positionParent = doc.selection.getLastPosition().parent;\n\n\t\t\tif ( doc.selection.isCollapsed && positionParent.isEmpty && command.value ) {\n\t\t\t\tthis.editor.execute( 'blockQuote' );\n\t\t\t\tthis.editor.editing.view.scrollToTheSelection();\n\n\t\t\t\tdata.preventDefault();\n\t\t\t\tevt.stop();\n\t\t\t}\n\t\t} );\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}